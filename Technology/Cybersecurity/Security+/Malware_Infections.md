# Malware Infections # 

## Malware Infections ## 

Threat Vector: Method used by an attacker to access a victim's machine 

Attack Vector: Method used by an attacker to gain access to a victim's machine in order to infect it with malware 

## Common Delivery Methods ## 

Malware infections usually start within software, messaging, and media 

Watering Holes: Malware placed on a website that is known to be accessed by potential victims on a regular/scheduled basis 

## Botnets and Zombies ## 

Botnet: A collection of compromised computers under the control of a master node 

Botnets can be utilized in other processor-intensive functions and activities 

## Active Interception & Privelege Escalation ## 

Active Intersection: Occurs when a computer is placed between the sender and receiver and is able to capture or modify the traffic between them 

Privilege Escalation: Occurs when one is able to exploit a design flaw or bug in a system to gain access to resources that a normal user isn't able to access 

## Backdoors and Logic Bombs ## 

Backdoors are used to bypass normal security and authentication functions 

Remote Access Trojan [RAT] is placed by an attacker to maintain persistent access 

Easter Egg: Non-malicious code that when invoked, displays an inside joke, hidden message, or secret feature 

Logic Bomb: Malicious code that has been inserted inside a program and will execute only when certain conditions have been met 

Logic bombs and Easter eggs should not be used according to secure coding standards 

## Symptoms of Infections ## 

One's computer may have been infected if it begins to act strangely 

Hard drives, files, or applications are not accessible anymore 

Strange noises occur 

Unusual error messages 

Display looks strange 

Jumbled printouts 

Double file extensions are being displayed, such as textfile.txt.exe 

New files and folders have been created or files and folders are missing/corrupted 

System Restore will not function 

## Removing Malware ## 

Identify symptoms of a malware infection 

Quarantine the infected systems 

Disable System Restore [if using a Windows machine][to prevent Windows from taking further snapshots of an infected machine]  

Remediate the infected system 

Schedule automatic updates and scans 

Enable System Restore and create a new restore point 

Provide end-user security awareness training 

If a boot sector virus is suspected, reboot the computer from an external device and scan it 

## Preventing Malware ## 

Worms, Trojans, and Ransomware are best detected with anti-malware solutions 

For spyware - anti-spyware solutions 

Scanners can detect a file containing a rootkit before it is installed, but once installed, it becomes very diffucult to detect 

Removal of a rootkit is difficult and the best plan is to reimage the machine 

Verify email servers aren't configured as open mail relays or SMTP open relays 

Remove email addresses from website 

Use allow/denylists 

Train and educate end-users 

Update anti-malware solution automatically and scan computer regularly 

Update and patch the OS and applications regularly 

Educate and train end-users on safe internet surfing practices 

## Malware Exploitation ## 

Exploit Technique: Describes the specific method by which malware code infects a target host 

Most modern malware uses file-less techniques to avoid detection by signature-based security software 

How does an APT use modern malware to operate? 
* Use dropper or downloader 
* Maintain access 
* Strengthen access 
* Actions on objectives 
* Concealment 

Dropper: Malware designed to install or run other types of malware embedded in a payload on an infected host 

Downloader: A piece of code that connects to the Internet to retrieve additional tools after the initial infection by a dropper 

Shellcode: Any lightweight code designed to run an exploit on the target, which may include any type of code format from scripting languages to binary code 

Exam Tip: Shellcode originally referred to malware code that would give the attacker a shell [command prompt] on the target system, but now more generally encapsulates the above definition 

Code Injection: Exploit technique that runs malicious code with the identification number of a legitimate process 
* Masquerading 
* DLL Injection 
* DLL Sideloading 
* Process Hollowing 

Droppers are likely to implement anti-forensics techniques to prevent detection and analysis 

Living Off the Land: Exploit techniques that use standard system tools and packages to perform intrusions 

Detection of an adversary is more difficult when they are executing malware code within standard tools and processes 