# Monitoring and Auditing # 

## Monitoring Types ## 

Signature-Based: Network traffic is analyzed for predetermined attack patterns 

Anomaly-Based: A baseline is established and any network traffic that is outside of the baseline is evaluated 

Behavior-Based: Activity is evaluated based on the previous behavior of applications, executables, and the operating system in comparison to the current activity of the system 

Methods may be combined into a hybrid approach in some IDS/IPS systems 

## Performance Baselining ## 

Baselining: Process of measuring changes in networking, hardware, software, and applications 

Baseline Reporting: Documenting and reporting on changes in a baseline 

Security Posture: Risk level to which a system or other technology element is exposed 

## Protocol Analyzers ## 

Protocol analyzers are used to capture and analyze network traffic 

Promiscuous Mode: Network adapter is able to capture all of the packets on the network regardless of the destination MAC address of the frames carrying them 

Non-Promiscuous Mode: Network adapter can only capture the packets addressed to itself directly 

To capture the most information, one needs to be in promiscuous mode 

Port Mirroring: One or more switch ports are configured to forward all of their packets to another port on the switch 

If a SPAN port cannot be configured, use a network tap 

Network Tap: A physical device that allows one to intercept the traffic between two points on the network 

## SNMP ## 

Simple Network Management Protocol [SNMP]: A TCP/IP protocol that aids in monitoring network-attached devices and computers 

SNMP is incorporated into a network management and monitoring system 

Managed Devices: Computers and other network-attached devices monitored through the use of agents by a network management system 

Agents: Software that is loaded on a managed device to reidrect information to the network management system 

Network Management System [NMS]: Software run on one or more servers to control the monitoring of network-attached devices and computers 

SNMP v1/v2 are insecure due to the use of community strings to access a device 

SNMP v3: Version of SNMP that provides integrity, authentication, and encryption of the messages being sent over the network 

Management should be conducted on an out-of-band network to increase security 

## Auditing ## 

Auditing: A technical assessment conducted on applications, systems, or networks 

Auditing is a detective control 

Software tools are also used to help conduct auditing 

## Logging ## 

Logs: Data files that contain the accounting and audit trail for actions performed by a user on the computer or network 

Security, System, and Application logs should be audited on a Windows system 

Security Logs: Logs the events such as successful and unsuccessful user logons to the system 

System Logs: Logs the events such as a system shutdown and driver failures 

Application Logs: Logs the events for the operating system and third-party applications 

To consolidate all the logs into a single repository, can use SYSLOG 

SYSLOG: A standardized format used for computer message logging that allows for the separation of the software that generates messages, the system that stores them, and the software that reports and analyzes them 

SYSLOG uses port 514 over UDP 

## Log Files ## 

Log files are important to one's ability to reconstruct an event after it occurs 

Log File Maintenance: Actions taken to ensure the proper creation and storage of a log file, such as the proper configuration, saving, backing up, securing, and encrypting of the log files 

Log files should be saved to a different partition or an external server 

Overwrite Events: When a maximum log size is reached, the system can begin overwriting the oldest events in the log files to make room 

Logs should be archived and backed up to ensure they are available when required 

Write Once Read Many [WORM]: Technology like a DVD-R that allows data to be written only once but read unlimited times 

## SIEM ## 

Log review is a critical part of security assurance 

SIEM: A solution that provides real-time or near-real-time analysis of security alerts generated by network hardware and appliances 

SIEM solutions can be implemented as software, hardware appliances, or outsourced managed services 

When implementing a SIEM: 
* Log all relevant events and filter irrelevant data 
* Establish and document scope of events 
* Develop use cases to define a threat 
* Plan incident response for an event 
* Establish a ticketing process to track events 
* Schedule regular threat hunting 
* Prove auditors and analysts an evidence trail 

There are many commercial and open-source SIEM solutions available 

Splunk: A market-leading big data information gathering and analysis tool that can import machine-generated data via a connector or visibility add-on 

Splunk may be installed locally or as a cloud-based solution 

ELK/Elastic Stack: Collection of free and open-source SIEM tools that provides storage, search, and analysis functions 

ELK Components: 
* Elasticsearch [query/analytics] 
* Logstash [log collection/normalization] 
* Kibana [visualization] 
* Beats [endpoint collection agents] 

ELK Stack may be installed locally or as a cloud-based solution 

ArcSight: A SIEM log management and analytics software that can be used for compliance reporting for legislation and regulations like HIPPA, SOX, and PCI DSS 

QRadar: A SIEM log management, analytics, and compliance reporting platform created by IBM 

Alien Vault and OSSIM [Open-Source Security Information Management]: A SIEM solution originally developed by Alien Vault, now owned by AT&T, and rebranded as AT&T Cybersecurity 

OSSIM can integrate other open-source tools, such as the Snort IDS and OpenVAS vulnerability scanner, and provide an integrated web administrative tool to manage the whole security environment 

Graylog: An open-source SIEM with an enterprise version focused on compliance and supporting IY operations and DevOps 

## Syslog ## 

Syslog: A protocol enabling different appliances and software applications to transmit logs or event records to a central server 

Syslog follows a client-server model and is the defacto standard for logging of events from distributed systems 

Syslog runs on most operating systems and network equipment using port 514 [UDP] over TCP/IP 

A syslog message contains a PRI code, a header, and a message portion 

The PRI code is calculated from the facility and severity level of the data 

The header contains the timestamp of the event and the hostname 

The message portion contains the source process of the event and related content 

Original drawback[s] to syslog: 
* Since syslog relied on UDP, there can be delivery issues within congested networks 
* Basic security controls like encryption and authentication are not included by default within syslog 

Due to these issues, newer syslog implementations added new features and capabilities 
* Newer implementations can use port 1468 [TCP] for consistent delivery 
* Newer implementations can use TLS to encrypt messages sent to servers 
* Newer implementations can use MD-5 or SHA-1 for authentication and integrity 
* Some newer implementations can use message filtering, automated log analysis, event response scripting, and alternate message formats 

The newer version of the server is called syslog-ng or rsyslog 

Syslog can refer to the protocol, the server, or the log entries themselves 

## SOAR ## 

Security Orchestration, Automation, and Response [SOAR]: A class of security tools that facilitates incident response, threat hunting, and security configuration by orchestrating automated runbooks and delivering data enrichment 

SOAR is primarily used for incident response 

Next-Gen SIEM: A security information and event monitoring system with an integrated SOAR 

SOAR Capabilities/Features: 
* Scan security/threat data 
* Analyze it with ML 
* Automate data enrichment 
* Provision new resources 

Playbook: A checklist of actions to perform to detect and respond to a specific type of incident 

Runbook: An automated version of a playbook that leaves clearly defined interaction points for human analysis 